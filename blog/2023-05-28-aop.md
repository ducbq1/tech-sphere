---
slug: aop
title: Aspect Oriented Programming (AOP)
authors: [ducbq1, slorber, yangshun]
tags: [hola, docusaurus]
---
**Aspect Oriented Programming (AOP)** – lập trình hướng khía cạnh: là một kỹ thuật lập trình (kiểu như lập trình hướng đối tượng) nhằm phân tách chương trình thành các module riêng biệt, phân biệt, không phụ thuộc nhau. Khi hoạt động, chương trình sẽ kết hợp các module lại để thực hiện các chức năng, nhưng khi sửa đổi một chức năng thì chỉ cần sửa một module.

AOP không phải dùng để thay thế OOP mà để bổ sung cho OOP.

<!-- truncate -->


# Giới thiệu về **Aspect Oriented Programming (AOP)**

**Aspect Oriented Programming (AOP)** – lập trình hướng khía cạnh: là một kỹ thuật lập trình (kiểu như lập trình hướng đối tượng) nhằm phân tách chương trình thành các module riêng biệt, phân biệt, không phụ thuộc nhau. Khi hoạt động, chương trình sẽ kết hợp các module lại để thực hiện các chức năng, nhưng khi sửa đổi một chức năng thì chỉ cần sửa một module.

AOP không phải dùng để thay thế OOP mà để bổ sung cho OOP.

## Ví dụ:

1. **Công ty và các phòng ban:**

   Một công ty được chia thành nhiều phòng ban như phòng kỹ thuật, phòng kế toán, phòng kinh doanh (mỗi phòng giống như một module trong chương trình). Mỗi phòng thực hiện một nhiệm vụ riêng, nhưng cần kết hợp lại để vận hành công ty.

   - Trong AOP có khái niệm "lát cắt", "điểm cắt", tạm hiểu là module A sẽ xen vào module B để thực hiện một chức năng nào đó mà không làm ảnh hưởng module B. "Điểm cắt" là vị trí mà module A xen vào module B.

   Ví dụ: Tất cả nhân viên đều cần phải quyết toán thuế. Nếu từng người một thực hiện, sẽ tốn thời gian và ảnh hưởng tới công ty. Phòng kế toán sẽ thực hiện quyết toán cho tất cả nhân viên. Nếu luật thuế thay đổi, phòng kế toán chỉ cần sửa lại mà không ảnh hưởng đến các phòng ban khác.
2. **Viết log trong code:**

   Trong code, bạn thường thực hiện viết log cho các method (ví dụ: method nào chạy, lỗi gì xảy ra). Việc viết log không liên quan đến chức năng của method.

   - Giờ yêu cầu chuyển sang chỉ viết log khi bắt đầu các method, bạn phải sửa tất cả các method đó. Với AOP, bạn có thể phân tách chức năng log ra thành một module riêng và sử dụng nó để thực hiện các lát cắt với các method cần log.
   - Ví dụ: Bạn có thể log ở đầu method hoặc cuối method, tùy vào điểm cắt bạn chọn.
3. **Filter trong lập trình web:**

   Trong lập trình web, **filter** là một khái niệm dùng để xử lý tất cả các request.

   - Ví dụ: Mỗi request cần xác thực (kiểm tra login). Bạn có thể sử dụng một filter để thực hiện xác thực và nếu cần thay đổi cách xác thực, bạn chỉ cần sửa filter mà không ảnh hưởng đến các phần khác của hệ thống.

## Các thuật ngữ trong AOP:

- **Core Concern / Primary Concern:** Là yêu cầu hoặc logic xử lý chính của chương trình.
- **Cross-Cutting Concern:** Những logic phụ cần được thực hiện khi core concern được gọi, như security, logging, tracing, monitoring, access control, error handling, transaction management, session management, input/output validation, ...
- **Joinpoint:** Là một điểm trong chương trình, nơi có thể chèn các cross-cutting concern. Ví dụ: Sau khi chạy một method, ta muốn ghi log, thì điểm sau khi method thực thi là một joinpoint.
- **Pointcut:** Là cách xác định Joinpoint, sử dụng biểu thức để kiểm tra và xác định xem liệu **Advice** có cần thực thi hay không.
- **Advice:** Các xử lý phụ được thêm vào xử lý chính. Các loại **Advice**:
  - **Before:** Thực thi trước Joinpoint.
  - **After:** Thực thi sau Joinpoint.
  - **Around:** Thực thi trước và sau Joinpoint.
  - **After Returning:** Thực thi sau khi Joinpoint hoàn thành bình thường.
  - **After Throwing:** Thực thi sau khi Joinpoint kết thúc với một Exception.
- **Aspect:** Tương tự như một Java class. Aspect đóng gói toàn bộ cross-cutting concern và có thể chứa JoinPoint, PointCut, và Advice.
- **Target Object:** Là đối tượng mà **Advice** được áp dụng vào.
