<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">One post tagged with &quot;abac&quot; | Tech Sphere</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ducbq1.github.io/tech-sphere/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ducbq1.github.io/tech-sphere/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ducbq1.github.io/tech-sphere/blog/tags/abac"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="One post tagged with &quot;abac&quot; | Tech Sphere"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/tech-sphere/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ducbq1.github.io/tech-sphere/blog/tags/abac"><link data-rh="true" rel="alternate" href="https://ducbq1.github.io/tech-sphere/blog/tags/abac" hreflang="en"><link data-rh="true" rel="alternate" href="https://ducbq1.github.io/tech-sphere/blog/tags/abac" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/tech-sphere/blog/rss.xml" title="Tech Sphere RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tech-sphere/blog/atom.xml" title="Tech Sphere Atom Feed"><link rel="stylesheet" href="/tech-sphere/assets/css/styles.b8d2aa6b.css">
<script src="/tech-sphere/assets/js/runtime~main.2c81eaa0.js" defer="defer"></script>
<script src="/tech-sphere/assets/js/main.129b135e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/tech-sphere/img/logo.svg"><link rel="preload" as="image" href="/tech-sphere/avatar/ducbq1.jpg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/tech-sphere/"><div class="navbar__logo"><img src="/tech-sphere/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/tech-sphere/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TechSphere</b></a><a class="navbar__item navbar__link" href="/tech-sphere/docs/intro">Hướng dẫn</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/tech-sphere/blog">Bài viết</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ducbq1" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Các bài gần đây</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/svn">SVN và Git</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/webflux">Tổng hợp kiến thức Spring WebFlux</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/abac">Kiểm Soát Truy Cập Dựa Trên Thuộc Tính Đơn Giản Với Spring Security</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/devops">Kiến Thức Cần Có Của Một DevOps Engineer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/linux">Linux cơ bản cho DevOps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/cqrs">CQRS (Command Query Responsibility Segregation)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/proxy">Tổng quan về Proxy, Reverse Proxy vs. Forward Proxy, Forward Port, Load Balancer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/banking">Kiến Thức và Thuật Ngữ Banking Dành Cho Lập Trình Viên</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/sql-optimization-guide">Kỹ Thuật Tối Ưu SQL</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/standard-network-model-and-knowledge">Mô Hình Mạng Tiêu Chuẩn &amp; Kiến Thức Cần Có Cho Lập Trình Viên</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/cursor-state">Cài đặt loading con trỏ chuột trong WPF (Windows Presentation Foundation)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/retry-mechanism">Thread tự động retry kết nối tới API nếu bị mất kết nối</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/jwt-oauth2-vs-filter">So sánh OAuth2 JWT và JWT Filter</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/rsassasigner-vs-macsigner-nimbus-jwt">So sánh RSASSASigner và MACSigner trong Nimbus JOSE + JWT</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/web">Cơ bản về ứng dụng web</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/aop">Aspect Oriented Programming (AOP)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/csharp">Những Tính Năng Mới Trong C# Từ Phiên Bản 8 Đến 12</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/tool">Danh sách công cụ quản lý nhiều phiên bản</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2021</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/welcome">Welcome</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/mdx-blog-post">MDX Blog Post</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2019</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/long-blog-post">Long Blog Post</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tech-sphere/blog/first-blog-post">First Blog Post</a></li></ul></div></nav></aside><main class="col col--7"><header class="margin-bottom--xl"><h1>One post tagged with &quot;abac&quot;</h1><a href="/tech-sphere/blog/tags">View All Tags</a></header><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/tech-sphere/blog/abac">Kiểm Soát Truy Cập Dựa Trên Thuộc Tính Đơn Giản Với Spring Security</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-04-08T00:00:00.000Z">April 8, 2025</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/tech-sphere/blog/authors/ducbq-1"><img class="avatar__photo authorImage_XqGP" src="/tech-sphere/avatar/ducbq1.jpg" alt="Bùi Quang Đức"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/tech-sphere/blog/authors/ducbq-1"><span class="authorName_yefp">Bùi Quang Đức</span></a></div><small class="authorTitle_nd0D" title="CV phát triển ứng dụng | P.PTUD giao dịch CN &amp; QTNB - Trụ sở chính VietinBank">CV phát triển ứng dụng | P.PTUD giao dịch CN &amp; QTNB - Trụ sở chính VietinBank</small><div class="authorSocials_rSDt"><a href="https://x.com/ducbq1" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/ducbq1" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div class="markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="giới-thiệu">Giới Thiệu<a href="#giới-thiệu" class="hash-link" aria-label="Direct link to Giới Thiệu" title="Direct link to Giới Thiệu">​</a></h2>
<p>Bạn đã từng làm việc trên phần mềm mà các quy tắc truy cập không chỉ dựa trên vai trò của người dùng mà còn dựa trên thực thể cụ thể mà vai trò đó được cấp quyền chưa?
Ví dụ như &quot;Quản lý dự án có thể thêm người dùng vào <strong>DỰ ÁN CỦA HỌ</strong>&quot;, &quot;Nhân viên cửa hàng có thể truy cập thông tin <strong>CỬA HÀNG CỦA HỌ</strong>&quot;, hoặc &quot;Chủ sở hữu tài liệu có thể chỉnh sửa <strong>TÀI LIỆU CỦA HỌ</strong>&quot;?</p>
<p>Hoặc, nơi các quy tắc truy cập dựa trên ngữ cảnh, như thời gian, mạng người dùng, hoặc kênh truy cập (như trang web, ứng dụng di động, hệ thống nội bộ, v.v.).
Ví dụ, &quot;Tài nguyên này chỉ có thể được truy cập <strong>TRONG GIỜ HÀNH CHÍNH</strong> hoặc <strong>CHỈ TỪ MẠNG NỘI BỘ</strong>&quot;?</p>
<p>Tất cả những điều đó, và vẫn cần logic của các quy tắc truy cập này có thể cấu hình và linh hoạt để được sửa đổi với ít (hoặc không) mã hóa phần mềm hoặc triển khai mới.</p>
<p>Nếu vậy, bạn có thể thấy <strong>Kiểm Soát Truy Cập Dựa Trên Thuộc Tính (Attribute-Based Access Control - ABAC)</strong> rất hữu ích.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="abac-là-gì">ABAC là gì?<a href="#abac-là-gì" class="hash-link" aria-label="Direct link to ABAC là gì?" title="Direct link to ABAC là gì?">​</a></h2>
<p>Mọi yêu cầu truy cập sẽ có bốn yếu tố (chủ thể, tài nguyên, hành động và môi trường), trong đó:</p>
<ul>
<li><strong>Chủ thể</strong>: thực thể (thường là người dùng) yêu cầu truy cập.</li>
<li><strong>Tài nguyên</strong>: đối tượng mà chủ thể muốn truy cập.</li>
<li><strong>Hành động</strong>: thao tác mà chủ thể muốn thực hiện trên tài nguyên.</li>
<li><strong>Môi trường</strong>: bối cảnh của yêu cầu truy cập (thời gian, vị trí, phương thức truy cập, v.v.).</li>
</ul>
<p><strong>ABAC</strong> cho phép hoặc từ chối truy cập dựa trên các thuộc tính của các yếu tố này.</p>
<p>Ví dụ, một quy tắc có thể là:</p>
<blockquote>
<p>&quot;Cho phép truy cập nếu vai trò của người dùng là &#x27;Quản lý dự án&#x27; và ID dự án trong yêu cầu khớp với ID dự án mà người dùng quản lý&quot;.</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="spring-security-và-spel">Spring Security và SpEL<a href="#spring-security-và-spel" class="hash-link" aria-label="Direct link to Spring Security và SpEL" title="Direct link to Spring Security và SpEL">​</a></h2>
<p>Spring Security cho phép các nhà phát triển tiêm logic kiểm soát truy cập của họ vào một thành phần tập trung và được thực thi (sử dụng kiểm soát truy cập dựa trên biểu thức) tại nhiều điểm thực thi khác nhau của ứng dụng, như trước/sau các cuộc gọi REST API và phương thức. Nó cung cấp tất cả ngữ cảnh cần thiết (tham số phương thức hoặc đối tượng trả về) để áp dụng logic kiểm soát truy cập.</p>
<p>SpEL (Spring Expression Language) là một ngôn ngữ biểu thức tương tự như Java EL, và được sử dụng trong Spring Security để định nghĩa các biểu thức truy cập.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="thành-phần-chính">Thành Phần Chính<a href="#thành-phần-chính" class="hash-link" aria-label="Direct link to Thành Phần Chính" title="Direct link to Thành Phần Chính">​</a></h2>
<p>Phương pháp được trình bày trong bài viết này dựa trên các ý tưởng sau:</p>
<ul>
<li>Sử dụng các biểu thức Spring EL kiểu boolean để định nghĩa các quy tắc truy cập (ví dụ: <code>subject.project.id == resource.project.id</code>), các biểu thức này sẽ được lưu trữ trong một kho trung tâm (ví dụ: bộ nhớ, cơ sở dữ liệu, LDAP, tệp).</li>
<li>Định nghĩa một thành phần tập trung có nhiệm vụ tải các quy tắc, bao bọc các yếu tố trong ngữ cảnh truy cập, và đánh giá các biểu thức quy tắc để quyết định xem truy cập có được cho phép hay không.</li>
<li>Sử dụng các annotation của Spring như <code>@PostAuthorize</code> / <code>@PreAuthorize(&quot;hasPermission(...)&quot;)</code> (cùng với các thành phần khác được đề cập sau) để thực thi các quy tắc truy cập.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="các-thành-phần-chính-trong-phương-pháp-này-bao-gồm">Các thành phần chính trong phương pháp này bao gồm:<a href="#các-thành-phần-chính-trong-phương-pháp-này-bao-gồm" class="hash-link" aria-label="Direct link to Các thành phần chính trong phương pháp này bao gồm:" title="Direct link to Các thành phần chính trong phương pháp này bao gồm:">​</a></h3>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissionevaluator"><code>PermissionEvaluator</code><a href="#permissionevaluator" class="hash-link" aria-label="Direct link to permissionevaluator" title="Direct link to permissionevaluator">​</a></h3>
<p>Đây là điểm đầu vào để thực thi logic ABAC. Như đã đề cập trước đó, tất cả các quyết định truy cập được thực hiện bởi Spring Security (theo mô hình kiểm soát truy cập dựa trên biểu thức) đều được ủy quyền cho thành phần này. Tức là, tất cả các annotation như <code>@PreAuthorize(&quot;hasPermission(...)&quot;)</code>, <code>@PostAuthorize(&quot;hasPermission(...)&quot;)</code> sẽ được chuyển đến thành phần này để xử lý.</p>
<p>Phương pháp được trình bày ở đây tạo ra một lớp triển khai tùy chỉnh của thành phần <code>PermissionEvaluator</code>, lớp này đơn giản chỉ ủy quyền việc đưa ra quyết định truy cập cho thành phần <code>PolicyEnforcement</code>.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class AbacPermissionEvaluator implements PermissionEvaluator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PolicyEnforcement policy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public boolean hasPermission(Authentication authentication , Object targetDomainObject, Object permission) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Getting subject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object user = authentication.getPrincipal();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Getting environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map&lt;String, Object&gt; environment = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        environment.put(&quot;time&quot;, new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return policy.check(user, targetDomainObject, permission, environment);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public boolean hasPermission(Authentication authentication, Serializable targetId, String targetType, Object permission) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contextawarepolicyenforcement"><code>ContextAwarePolicyEnforcement</code><a href="#contextawarepolicyenforcement" class="hash-link" aria-label="Direct link to contextawarepolicyenforcement" title="Direct link to contextawarepolicyenforcement">​</a></h3>
<p>Đây là một thành phần tùy chọn, tương tự như <code>PermissionEvaluator</code>, nhưng có thể được gọi tại  <strong>bất kỳ đâu trong mã nguồn</strong> , miễn là <code>SecurityContext</code> đã được khởi tạo và chứa thông tin xác thực của người dùng hiện tại.</p>
<p>Thành phần này được sử dụng trong những trường hợp mà <strong>dữ liệu cần thiết để đưa ra quyết định truy cập không sẵn có</strong> cho các annotation <code>@PreAuthorize</code> và <code>@PostAuthorize</code>.</p>
<p>Ví dụ, trong trường hợp cập nhật một thực thể:</p>
<ul>
<li><code>@PreAuthorize</code> chỉ có thể truy cập vào  <strong>các tham số truyền vào phương thức</strong> , tức là dữ liệu của thực thể sau khi cập nhật, trong khi quyết định truy cập lại <strong>phụ thuộc vào dữ liệu của thực thể hiện có</strong> trong hệ thống.</li>
<li><code>@PostAuthorize</code> sẽ được gọi  <strong>sau khi quá trình cập nhật hoàn tất</strong> , điều này là  <strong>quá muộn để thực hiện kiểm tra quyền truy cập</strong> .</li>
</ul>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class ContextAwarePolicyEnforcement {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected PolicyEnforcement policy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void checkPermission(Object resource, String permission) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Getting the subject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Authentication auth = SecurityContextHolder.getContext().getAuthentication();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Getting the environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map&lt;String, Object&gt; environment = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        environment.put(&quot;time&quot;, new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if(!policy.check(auth.getPrincipal(), resource, permission, environment))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new AccessDeniedException(&quot;Access is denied&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="policyenforcement"><code>PolicyEnforcement</code><a href="#policyenforcement" class="hash-link" aria-label="Direct link to policyenforcement" title="Direct link to policyenforcement">​</a></h3>
<p>Đây là nơi  <strong>quyết định truy cập thực sự được đưa ra</strong> . Cơ chế hoạt động như sau:</p>
<ol>
<li><strong>Tải tất cả các <code>PolicyRule</code></strong> thông qua <code>PolicyDefinition</code>.</li>
<li><strong>Lọc các <code>PolicyRule</code></strong> để chỉ giữ lại những quy tắc <strong>có thể áp dụng</strong> (tức là các quy tắc mà biểu thức <code>target</code> được đánh giá là <code>true</code>) trong ngữ cảnh truy cập hiện tại.</li>
<li><strong>Đánh giá tất cả các <code>PolicyRule</code> áp dụng được</strong> (tức là đánh giá biểu thức điều kiện) trong ngữ cảnh truy cập hiện tại. Nếu  <strong>bất kỳ biểu thức nào trả về <code>true</code></strong> , quyền truy cập sẽ được cấp;  <strong>ngược lại</strong> , truy cập sẽ bị từ chối.</li>
</ol>
<blockquote>
<p>Lý do mà chúng ta <strong>không hiện thực logic này trực tiếp trong <code>PermissionEvaluator</code></strong> là để  <strong>tách biệt logic ABAC khỏi Spring Security</strong> , và cho phép việc đưa ra quyết định có thể được gọi <strong>ngoài phạm vi Spring Security Framework</strong> (ví dụ: bằng cách gọi trực tiếp <code>PolicyEnforcement</code> trong bất kỳ logic nào của phương thức).</p>
</blockquote>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class BasicPolicyEnforcement implements PolicyEnforcement {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private PolicyDefinition policyDefinition;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public boolean check(Object subject, Object resource, Object action, Object environment) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Get all policy rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List&lt;PolicyRule&gt; allRules = policyDefinition.getAllPolicyRules();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Wrap the context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SecurityAccessContext cxt = new SecurityAccessContext(subject, resource, action, environment);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //Filter the rules according to context.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List&lt;PolicyRule&gt; matchedRules = filterRules(allRules, cxt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //finally, check if any of the rules are satisfied, otherwise return false.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return checkRules(matchedRules, cxt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private List&lt;PolicyRule&gt; filterRules(List&lt;PolicyRule&gt; allRules, SecurityAccessContext cxt) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List&lt;PolicyRule&gt; matchedRules = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for(PolicyRule rule : allRules) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if(rule.getTarget().getValue(cxt, Boolean.class)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    matchedRules.add(rule);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } catch(EvaluationException ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                logger.error(&quot;An error occurred while evaluating PolicyRule.&quot;, ex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return matchedRules;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private boolean checkRules(List&lt;PolicyRule&gt; matchedRules, SecurityAccessContext cxt) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for(PolicyRule rule : matchedRules) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if(rule.getCondition().getValue(cxt, Boolean.class)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } catch(EvaluationException ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                logger.error(&quot;An error occurred while evaluating PolicyRule.&quot;, ex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="policydefinition"><code>PolicyDefinition</code><a href="#policydefinition" class="hash-link" aria-label="Direct link to policydefinition" title="Direct link to policydefinition">​</a></h3>
<p>Đây là  <strong>interface đại diện cho kho lưu trữ <code>PolicyRule</code></strong> . Nó chỉ có một phương thức duy nhất là <code>getAllPolicyRules</code>, dùng để tải tất cả các quy tắc truy cập hiện có.</p>
<p>Interface này giúp <strong>ẩn đi chi tiết về cách lưu trữ các quy tắc truy cập</strong> đối với các client sử dụng policy. Thành phần này có thể được hiện thực cho (nhưng không giới hạn ở): policy lưu trong bộ nhớ (<code>in-memory</code>), file JSON, hoặc cơ sở dữ liệu. Cách thức lưu trữ cụ thể sẽ do bên triển khai thành phần này quyết định.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="policyrule"><code>PolicyRule</code><a href="#policyrule" class="hash-link" aria-label="Direct link to policyrule" title="Direct link to policyrule">​</a></h3>
<p>Đây là <strong>thành phần nguyên tử (atomic)</strong> của một chính sách truy cập – nơi <strong>định nghĩa logic ABAC</strong> sẽ được đánh giá khi cần thiết.</p>
<p><code>PolicyRule</code> có các thuộc tính chính sau:</p>
<ul>
<li><code>target</code>: Một biểu thức boolean sử dụng SpEL (Spring Expression Language) xác định khi nào quy tắc này <strong>có hiệu lực</strong> (nếu biểu thức đánh giá là <code>true</code>, thì quy tắc sẽ được áp dụng).</li>
<li><code>condition</code>: Một biểu thức boolean SpEL xác định khi nào quy tắc này <strong>được thoả mãn</strong> (nếu biểu thức đánh giá là <code>true</code>, thì truy cập sẽ được cho phép).</li>
</ul>
<p>Cả hai biểu thức trên đều <strong>có quyền truy cập đến bốn thành phần</strong> trong yêu cầu truy cập: <code>subject</code> (đối tượng), <code>resource</code> (tài nguyên), <code>action</code> (hành động), và <code>environment</code> (môi trường).</p>
<blockquote>
<p>Để đơn giản hóa, các <code>Rule</code> mặc định chỉ có <strong>tác dụng tích cực</strong> (tức là cho phép truy cập nếu được thỏa mãn), nhưng chúng có thể được mở rộng dễ dàng để có <strong>tác dụng tiêu cực</strong> (tức là từ chối truy cập nếu được thỏa mãn).</p>
</blockquote>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="securityaccesscontext"><code>SecurityAccessContext</code><a href="#securityaccesscontext" class="hash-link" aria-label="Direct link to securityaccesscontext" title="Direct link to securityaccesscontext">​</a></h3>
<p>Đây là một <strong>lớp wrapper</strong> chứa tất cả các thành phần của một yêu cầu truy cập. Nó có các thuộc tính tương ứng với từng thành phần: <code>Subject</code>, <code>Resource</code>, <code>Action</code>, và <code>Environment</code>.</p>
<p>Đối với mỗi quyết định truy cập cần thực hiện, một <strong>instance</strong> của lớp này sẽ được tạo bởi <code>PolicyEnforcement</code> và được <strong>gán các giá trị tương ứng</strong> với yêu cầu truy cập hiện tại.</p>
<p>Các instance này sẽ đóng vai trò là <strong>đối tượng gốc (Root Object)</strong> để đánh giá các biểu thức trong <code>PolicyRule</code>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tech-sphere/blog/tags/abac">abac</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tech-sphere/blog/tags/java">java</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tech-sphere/blog/tags/spring">spring</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tech-sphere/docs/intro">Hướng dẫn</a></li></ul></div><div class="col footer__col"><div class="footer__title">Cộng đồng</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Thêm nữa</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tech-sphere/blog">Nhật ký</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>