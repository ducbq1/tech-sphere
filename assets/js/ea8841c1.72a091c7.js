"use strict";(self.webpackChunktech_sphere=self.webpackChunktech_sphere||[]).push([[4452],{7407:n=>{n.exports=JSON.parse('{"permalink":"/tech-sphere/blog/retry-mechanism","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2025-04-04-retry-mechanism.md","source":"@site/blog/2025-04-04-retry-mechanism.md","title":"D\u01b0\u1edbi \u0111\xe2y l\xe0 v\xed d\u1ee5 \u0111\u01a1n gi\u1ea3n b\u1eb1ng Java v\u1ec1 c\xe1ch t\u1ea1o m\u1ed9t thread t\u1ef1 \u0111\u1ed9ng retry k\u1ebft n\u1ed1i t\u1edbi API n\u1ebfu b\u1ecb m\u1ea5t k\u1ebft n\u1ed1i","description":"T\u1ed5ng quan","date":"2025-04-04T00:00:00.000Z","tags":[{"inline":true,"label":"java","permalink":"/tech-sphere/blog/tags/java"},{"inline":true,"label":"spring boot","permalink":"/tech-sphere/blog/tags/spring-boot"}],"readingTime":2.135,"hasTruncateMarker":false,"authors":[{"name":"Yangshun Tay","title":"Front End Engineer @ Facebook","url":"https://github.com/yangshun","page":{"permalink":"/tech-sphere/blog/authors/yangshun"},"socials":{"x":"https://x.com/yangshunz","github":"https://github.com/yangshun"},"imageURL":"https://github.com/yangshun.png","key":"yangshun"}],"frontMatter":{"slug":"retry-mechanism","title":"D\u01b0\u1edbi \u0111\xe2y l\xe0 v\xed d\u1ee5 \u0111\u01a1n gi\u1ea3n b\u1eb1ng Java v\u1ec1 c\xe1ch t\u1ea1o m\u1ed9t thread t\u1ef1 \u0111\u1ed9ng retry k\u1ebft n\u1ed1i t\u1edbi API n\u1ebfu b\u1ecb m\u1ea5t k\u1ebft n\u1ed1i","authors":"yangshun","tags":["java","spring boot"]},"unlisted":false,"prevItem":{"title":"Trong WPF (Windows Presentation Foundation), \u0111\u1ec3 thay \u0111\u1ed5i cursor (con tr\u1ecf chu\u1ed9t), b\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng thu\u1ed9c t\xednh Mouse.OverrideCursor ho\u1eb7c FrameworkElement.Cursor","permalink":"/tech-sphere/blog/cursor-state"},"nextItem":{"title":"So s\xe1nh OAuth2 JWT v\xe0 JWT Filter","permalink":"/tech-sphere/blog/jwt-oauth2-vs-filter"}}')},8453:(n,e,t)=>{t.d(e,{R:()=>h,x:()=>s});var i=t(6540);const r={},c=i.createContext(r);function h(n){const e=i.useContext(c);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:h(n.components),i.createElement(c.Provider,{value:e},n.children)}},8716:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>h,metadata:()=>i,toc:()=>a});var i=t(7407),r=t(4848),c=t(8453);const h={slug:"retry-mechanism",title:"D\u01b0\u1edbi \u0111\xe2y l\xe0 v\xed d\u1ee5 \u0111\u01a1n gi\u1ea3n b\u1eb1ng Java v\u1ec1 c\xe1ch t\u1ea1o m\u1ed9t thread t\u1ef1 \u0111\u1ed9ng retry k\u1ebft n\u1ed1i t\u1edbi API n\u1ebfu b\u1ecb m\u1ea5t k\u1ebft n\u1ed1i",authors:"yangshun",tags:["java","spring boot"]},s="\ud83d\ude80 AdvancedApiConnectionRetry.java",l={authorsImageUrls:[void 0]},a=[{value:"T\u1ed5ng quan",id:"t\u1ed5ng-quan",level:2},{value:"\ud83e\udde9 C\xe1c th\xe0nh ph\u1ea7n ch\xednh",id:"-c\xe1c-th\xe0nh-ph\u1ea7n-ch\xednh",level:2},{value:"1. <code>ConnectionListener</code> (Interface)",id:"1-connectionlistener-interface",level:3},{value:"2. <code>RetryTask</code> (Runnable)",id:"2-retrytask-runnable",level:3},{value:"\ud83d\udd27 C\xe1c thu\u1ed9c t\xednh:",id:"-c\xe1c-thu\u1ed9c-t\xednh",level:4},{value:"\u25b6 Ph\u01b0\u01a1ng th\u1ee9c:",id:"-ph\u01b0\u01a1ng-th\u1ee9c",level:4},{value:"3. C\xe1ch s\u1eed d\u1ee5ng",id:"3-c\xe1ch-s\u1eed-d\u1ee5ng",level:3},{value:"\u2705 L\u1ee3i \xedch",id:"-l\u1ee3i-\xedch",level:2},{value:"\ud83d\udccc G\u1ee3i \xfd n\xe2ng cao",id:"-g\u1ee3i-\xfd-n\xe2ng-cao",level:2}];function o(n){const e={code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h2,{id:"t\u1ed5ng-quan",children:"T\u1ed5ng quan"}),"\n",(0,r.jsxs)(e.p,{children:["L\u1edbp ",(0,r.jsx)(e.code,{children:"AdvancedApiConnectionRetry"})," cung c\u1ea5p c\u01a1 ch\u1ebf k\u1ebft n\u1ed1i l\u1ea1i \u0111\u1ebfn m\u1ed9t API khi g\u1eb7p l\u1ed7i, h\u1ed7 tr\u1ee3 l\u1eafng nghe c\xe1c s\u1ef1 ki\u1ec7n nh\u01b0 th\xe0nh c\xf4ng, th\u1ea5t b\u1ea1i t\u1eebng l\u1ea7n th\u1eed, v\xe0 khi \u0111\u1ea1t gi\u1edbi h\u1ea1n retry t\u1ed1i \u0111a."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-c\xe1c-th\xe0nh-ph\u1ea7n-ch\xednh",children:"\ud83e\udde9 C\xe1c th\xe0nh ph\u1ea7n ch\xednh"}),"\n",(0,r.jsxs)(e.h3,{id:"1-connectionlistener-interface",children:["1. ",(0,r.jsx)(e.code,{children:"ConnectionListener"})," (Interface)"]}),"\n",(0,r.jsx)(e.p,{children:"Giao di\u1ec7n gi\xfap b\u1ea1n l\u1eafng nghe qu\xe1 tr\xecnh retry k\u1ebft n\u1ed1i API."}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"public interface ConnectionListener {\n    void onSuccess();                              // G\u1ecdi khi k\u1ebft n\u1ed1i th\xe0nh c\xf4ng\n    void onFailure(int attempt, Exception e);      // G\u1ecdi m\u1ed7i khi th\u1ea5t b\u1ea1i\n    void onMaxRetryReached();                      // G\u1ecdi khi retry t\u1ed1i \u0111a nh\u01b0ng v\u1eabn th\u1ea5t b\u1ea1i\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h3,{id:"2-retrytask-runnable",children:["2. ",(0,r.jsx)(e.code,{children:"RetryTask"})," (Runnable)"]}),"\n",(0,r.jsx)(e.p,{children:"L\u1edbp th\u1ef1c thi ch\xednh \u0111\u1ec3 th\u1ef1c hi\u1ec7n k\u1ebft n\u1ed1i v\xe0 t\u1ef1 \u0111\u1ed9ng retry n\u1ebfu th\u1ea5t b\u1ea1i."}),"\n",(0,r.jsx)(e.h4,{id:"-c\xe1c-thu\u1ed9c-t\xednh",children:"\ud83d\udd27 C\xe1c thu\u1ed9c t\xednh:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"apiUrl"}),": URL c\u1ee7a API c\u1ea7n k\u1ebft n\u1ed1i"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"maxRetry"}),": s\u1ed1 l\u1ea7n th\u1eed l\u1ea1i t\u1ed1i \u0111a"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"retryDelayMillis"}),": th\u1eddi gian ch\u1edd gi\u1eefa m\u1ed7i l\u1ea7n retry (milliseconds)"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"listener"}),": \u0111\u1ed1i t\u01b0\u1ee3ng l\u1eafng nghe s\u1ef1 ki\u1ec7n"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"-ph\u01b0\u01a1ng-th\u1ee9c",children:"\u25b6 Ph\u01b0\u01a1ng th\u1ee9c:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'@Override\npublic void run() {\n    int attempt = 0;\n    while (attempt < maxRetry) {\n        attempt++;\n        try {\n            HttpURLConnection connection = (HttpURLConnection) new URL(apiUrl).openConnection();\n            connection.setRequestMethod("GET");\n            int responseCode = connection.getResponseCode();\n\n            if (responseCode == 200) {\n                if (listener != null) listener.onSuccess();\n                return;\n            } else {\n                throw new IOException("Non-OK response: " + responseCode);\n            }\n        } catch (Exception e) {\n            if (listener != null) listener.onFailure(attempt, e);\n            try {\n                Thread.sleep(retryDelayMillis);\n            } catch (InterruptedException ie) {\n                Thread.currentThread().interrupt();\n                return;\n            }\n        }\n    }\n\n    if (listener != null) listener.onMaxRetryReached();\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"3-c\xe1ch-s\u1eed-d\u1ee5ng",children:"3. C\xe1ch s\u1eed d\u1ee5ng"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public static void main(String[] args) {\n    String apiUrl = "https://your-api-url.com";\n    int maxRetry = 5;\n    int delayMillis = 2000;\n\n    RetryTask task = new RetryTask(apiUrl, maxRetry, delayMillis, new ConnectionListener() {\n        @Override\n        public void onSuccess() {\n            System.out.println("\u2705 K\u1ebft n\u1ed1i th\xe0nh c\xf4ng!");\n        }\n\n        @Override\n        public void onFailure(int attempt, Exception e) {\n            System.out.println("\u274c L\u1ea7n th\u1eed " + attempt + " th\u1ea5t b\u1ea1i: " + e.getMessage());\n        }\n\n        @Override\n        public void onMaxRetryReached() {\n            System.out.println("\u26a0 \u0110\xe3 \u0111\u1ea1t gi\u1edbi h\u1ea1n retry nh\u01b0ng v\u1eabn th\u1ea5t b\u1ea1i.");\n        }\n    });\n\n    ExecutorService executor = Executors.newSingleThreadExecutor();\n    executor.execute(task);\n    executor.shutdown();\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-l\u1ee3i-\xedch",children:"\u2705 L\u1ee3i \xedch"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"H\u1eefu \xedch trong c\xe1c t\xecnh hu\u1ed1ng API t\u1ea1m th\u1eddi kh\xf4ng kh\u1ea3 d\u1ee5ng."}),"\n",(0,r.jsx)(e.li,{children:"Gi\u1ea3m thi\u1ec3u l\u1ed7i runtime do c\xe1c k\u1ebft n\u1ed1i kh\xf4ng \u1ed5n \u0111\u1ecbnh."}),"\n",(0,r.jsx)(e.li,{children:"C\u1ea5u tr\xfac r\xf5 r\xe0ng v\xe0 d\u1ec5 m\u1edf r\u1ed9ng."}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-g\u1ee3i-\xfd-n\xe2ng-cao",children:"\ud83d\udccc G\u1ee3i \xfd n\xe2ng cao"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Cho ph\xe9p c\u1ea5u h\xecnh method (GET, POST, ...) thay v\xec m\u1eb7c \u0111\u1ecbnh GET."}),"\n",(0,r.jsxs)(e.li,{children:["T\xedch h\u1ee3p ",(0,r.jsx)(e.code,{children:"Future"})," ho\u1eb7c ",(0,r.jsx)(e.code,{children:"CompletableFuture"})," \u0111\u1ec3 x\u1eed l\xfd b\u1ea5t \u0111\u1ed3ng b\u1ed9 t\u1ed1t h\u01a1n."]}),"\n",(0,r.jsxs)(e.li,{children:["Ghi log chi ti\u1ebft h\u01a1n ho\u1eb7c g\u1eedi alert khi ",(0,r.jsx)(e.code,{children:"onMaxRetryReached"}),"."]}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}}}]);